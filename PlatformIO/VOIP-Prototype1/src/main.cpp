#include <Arduino.h>
#include "audio_processing.h"
#include "web_server.h"

const int SAMPLE_SIZE = 512;
//*********************************************************************************************************************************
//***************************************            SETUP               ******************************************************
//*********************************************************************************************************************************
void setup()
{
  Serial.begin(115200);
  delay(1000);

  setupAudioProcessing();
  delay(500);

  //setupWebServer();
}

//*********************************************************************************************************************************
//***************************************             LOOP                   ******************************************************
//*********************************************************************************************************************************
void loop()
{
  //processAudioData();
  static int16_t audioBuffer[SAMPLE_SIZE]; // Static to avoid re-allocation on each loop iteration
  int numSamplesToRead = SAMPLE_SIZE; // Adjust based on your needs

  int samplesRead = processAudioData(audioBuffer, numSamplesToRead);
  if (samplesRead > 0)
  {
    // Audio data is now in audioBuffer and can be processed or transmitted
    Serial.print("Samples read: ");
    Serial.println(samplesRead);
  }
  delay(10);
}

//*********************************************************************************************************************************
//***************************************            FUNCTIONS               ******************************************************
//*********************************************************************************************************************************